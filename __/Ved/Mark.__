subclass Mark
  __init__
    get
    set
    backtick
  end

  def mark_init (m) proc
    ifnot (assoc_key_exists (MARKS, m))
      MARKS[m] = struct {pos = @Pos_Type, linlen};
  end

  def backtick (s)
    Ved.storePos (s, MARKS[string ('`')].pos);
  end

  def set (s)
    variable m = Input.getch (;disable_langchange);

    if ('a' <= m <= 'z')
      {
      m = string (m);
      mark_init (m);
      Ved.storePos (s, MARKS[m].pos);
      MARKS[m].linlen = __vlinlen (s, '.');
      }
  end

  def get ()
    variable marks = assoc_get_keys (MARKS);
    variable mark = Input.getch (;disable_langchange);

    mark = string (mark);

    ifnot (any (mark == marks))
      return NULL;

    variable m = @MARKS[mark];

    if (NULL == m.pos._i)
      return NULL;

    m;
  end
end
