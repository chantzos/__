class Dir
  def isdirectory (dir)
    if (-1 == access (dir, F_OK))
    return 0;

    variable st = stat_file (dir);
    File.is_type (NULL == st ? NULL : st.st_mode, "dir") ? 1 : -1;
  end

  def eval (dir)
    if ('~' == dir[0])
      (dir,) = strreplace (dir, "~", Path->HOME, 1);
    else if (0 == path_is_absolute (dir) && '$' != dir[0] &&
        0 == qualifier_exists ("dont_change"))
      dir = path_concat (getcwd (), dir);
    else
      dir = eval ("\"" + dir + "\"$");

    dir;
  end

  fun __isdirectory (dir, st)
  fun make (dir, perm)
  fun parent_tree (dir)
end
